#!/bin/sh -f

bush_home=`dirname $0`/../../../../bush

#//////////////////////////////////////////////////////////
#/// args : ///////////////////////////////////////////////
#//////////////////////////////////////////////////////////
what=
build_args=
while test $# -ge 1 ; do
  case $1 in
    -*) build_args="${build_args} $1";;
     *) if [ $# = 1 ] ; then what=$1; else echo "unknown option : $1"; fi;;
  esac
  shift
done

if [ "${what}" = "" ] ; then
  find . -maxdepth 1 -name '*.cpp' -exec ./build ${build_args} {} \;
  exit
fi

. ${bush_home}/header

#//////////////////////////////////////////////////////////
#/// look for an //inlib_build_use in the ${what} file ////
#//////////////////////////////////////////////////////////
auto_use_pack=inlib
auto_use_file="${what}"
. ${bush_home}/auto_use

#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////

name=${what}
name="`basename ${name}`"

name=`echo ${name} | sed -e 's:.cpp::g'`
name=`echo ${name} | sed -e 's:./::g'`

if [ ${build_verbose} = yes -o ${build_verbose_name} = yes ] ; then
  echo "inlib/examples/cpp/build ${name} ..."
fi

#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////

if [ "${build_use_our_stl}" = "yes" ] ; then  
  do_our_stl=yes
  if [ ${name} = "rcsv" ] ; then do_our_stl=no;fi
  if [ ${do_our_stl} = no ] ; then
    echo "${what} not compilable with inlib stl."
    exit
  fi
fi

if [ ${name} = "cern_root_TProfile" ] ; then
  cppflags="${cppflags} -I../../inlib/gT"
fi

#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////

use_inlib=yes

. ${bush_home}/use/inlib
. ${bush_home}/use/socket
. ${bush_home}/use/thread

#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////

app_src=${what}
app_exe=${name}
. ${bush_home}/application


